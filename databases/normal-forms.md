# Нормальные формы баз данных

[Ссылка на источник] (https://www.youtube.com/watch?v=zqQxWdTpSIA&ab_channel=ListenIT)

> Реляционная БД - это упорядоченная информация, связанная между собой определенными отношениями.Такие базы состоят из таблиц, в которых и содержится информация.

> Нормализация - метод проектирования базы данных, который позволяет привести БД к минимальной избыточности.

## Зачем нужна нормализация?

- Устранения аномалий;
- Повышения производительности;
- Повышения удобства управления даннымм.

Избыточность данных - это когда одни и те же данные храняться в нескольких местах базы, что приводит к аномалиям.

| id  | Наименование | Материал      |
| --- | ------------ | ------------- |
| 1   | Стул         | Металл        |
| 2   | Стол         | Массив дерева |
| 3   | Кровать      | ЛДСП          |
| 4   | Шкаф         | Массив дерева |
| 5   | Комод        | ЛДСП          |

Что же не так с этой таблицей?

Наименование и материал повторяются и для изменения требуется менять много строк таблицы. Возникают аномалии, которые не позволяют таблице оставаться консистентной.

Стоило сделать по-другому и внести в исходную таблицу идентификатор материала, который бы однозначно характеризовал каждую строку таблицы без повторений.

| id  | Наименование | Идентификатор материала |
| --- | ------------ | ----------------------- |
| 1   | Стул         | 2                       |
| 2   | Стол         | 1                       |
| 3   | Кровать      | 3                       |
| 4   | Шкаф         | 1                       |
| 5   | Комод        | 3                       |


| Идентификатор материала | Материал      |
| ----------------------- | ------------- |
| 1                       | Массив дерева |
| 2                       | Металл        |
| 3                       | ЛДСП          |

## Процесс нормализации

> Следyя определенным правилам и соблюдая определенные требования проектируются таблицы в базе данных. Правила группируются в наборы, и если база соответствует опредленному набору правил, то она находится в определенной нормальной форме.

> Нормальная форма базы данных - это набор правил и критериев, которым должна отвечать БД.

> Процесс нормализации - это последовательный процесс приведения базы данных к эталонному виду (переход от одной нормальной формы к следующей).

При этом жесткость накладываемых ограничений растет с наложением все новой формы.

Полный порядок нормальных форм:

1. Ненормальная форма или нулевая нормальная фоорма (UNF)
2. Первая нормальная форма (1NF)
3. Вторая нормальная форма (2NF)
4. Третья нормальная форма (3NF)
5. Нормальная форма Бойса-Кодда (BCNF)
6. Четвертая нормальная форма (4NF)
7. Пятая нормальная форма (5NF) 
8. Доменно-ключевая нормальная форма (DKNF)
9. Шестая нормальная форма (6NF)

Разберем каждую (или почти каждую, так как на практике нормализация до третьей нормальной формы считается достаточной) нормальную форму отдельно.

### Нулевая нормальная форма (UNF)

Обычно эту форму, как нормальную не выделяют, но лучше знать про нее, чем не знать. Здесь она рассмотрена, чтобы показать, какие БД являются реляционными, а какие нет.

 Перед приведением БД к нормальной формы нужно привести её к табличному виду так, чтобы он отвечал базовым принципам реляционной теории.

> Строки в таблицах не должны быть пронумерованы (порядок строк и столбцов не имеет значения).

В реляционных БД невозможно обращение к какой-то конкретной ячейке таблицы по ее номеру строки и столбцу (грубо говоря это не двумерный массив, а что-то иное)

Рассмотрим небольшой пример обычной таблицы Excel:

| Порядковый номер | А      | B       |
| ---------------- | ------ | ------- |
| 1                | Иван   | Иванов  |
| 2                | Петр   | Зюзин   |
| 3                | Сергей | Сергеев |
| 4                | Антон  | Семин   |
| 5                | Боб    | Сноу    |

Что не так с этой таблицей?

По сути тут есть порядковый номер, однако такая таблица не является реляционной, так как, если мы поменяем строки местами, то наша нумерация просто нарушится

Поэтому стоит удалить порядковый номер и дать столбцам нормальные имена


| last_name | first_name |
| --------- | ---------- |
| Иван      | Иванов     |
| Петр      | Зюзин      |
| Сергей    | Сергеев    |
| Антон     | Семин      |
| Боб       | Сноу       |


Теперь можно сказать, что данная таблица не нарушает базовые принципы реляционной теории и можно начинать приводить её к первой нормальной форме

### Первая нормальная форма (1NF)

Требование к первой нормальной форме очень простое и заключается в следующем:

> Таблицы должны соответствовать реляционной модели данных и соблюдать определенные реляционные принципы:

- В таблице не должно быть дублирующих строк;
- В каждой ячейке хранится атомарное значение (одно не составное значение);
- В столбце хранятся данные одного типа;
- Отсутствуют массивы и списки в любом виде.

Следующая таблица не находится даже в первой нормальной форме

| Сотрудник    | Контакт                                         |
| ------------ | ----------------------------------------------- |
| Иван. А. К.  | 123-345-422, 123-123-412                        |
| Петр Ж. Б.   | 345-123-435, 546-745-856                        |
| Сергей П. О. | Рабочий тел: 321-553-654, Домашний: 969-493-343 |
| Антон С. Ф.  | 434-245-566, 555-35-35                          |
| Боб  Ж. Ж.   | 969-69-69                                       |
| Боб  Ж. Ж.   | 969-69-69                                       |

Тут в ячейках хранятся повторяющиеся значения, а в контактах есть номера, которые хранятся через запятую.

Чтобы привести данную таблицу к первой нормальной форме, необходимо удалить повторящиеся строки и вынести тип телефона в отдельный столбец.

Тогда данная таблица в первой нормальной форме будет иметь следующий вид:

| Сотрудник    | Контакт                  | Тип телефона |
| ------------ | ------------------------ | ------------ |
| Иван. А. К.  | 123-345-422, 123-123-412 |              |
| Петр Ж. Б.   | 345-123-435, 546-745-856 |              |
| Сергей П. О. | 321-553-654              | Рабочий      |
| Сергей П. О. | 969-493-343              | Домашний     |
| Антон С. Ф.  | 434-245-566, 555-35-35   |              |
| Боб  Ж. Ж.   | 969-69-69                |              |

Таким образом главное правило первой нормальной формы:

- Назначение строк - хранить данные;
- Назначение столбцов - хранить структурную информацию;
- Назначение ячеек - хранить атомарное значени.
